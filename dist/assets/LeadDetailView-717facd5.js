import{d as Q,u as J,c as C,r as v,v as K,a as N,b as t,t as i,e as s,f as o,w as n,x as W,y as X,h as Y,o as h,i as A,k as u,l as Z,s as g,j as P,z as ee,F as te,A as le,n as $,m as se,q as x,B as oe,_ as ae}from"./index-6a6a99e0.js";import{s as D}from"./panel.esm-ff613c3e.js";import{s as ne}from"./calendar.esm-8470a1bf.js";import{s as L}from"./textarea.esm-9d24ae2a.js";import{u as ie}from"./useconfirm.esm-821a6f7e.js";import"./index.esm-8aa1b236.js";const de={key:0,class:"lead-detail-view"},ue={class:"lead-header"},re={class:"lead-title"},me={class:"lead-actions"},ce={class:"lead-content"},pe={class:"lead-main"},ve={class:"info-grid"},fe={class:"info-item"},be={class:"info-item"},ye={class:"info-item"},we={class:"info-item"},ke={class:"info-item"},Ce={class:"info-item"},ge={class:"info-item"},De={class:"lead-sidebar"},Ve={class:"timeline-item"},_e={class:"timeline-date"},Te={class:"timeline-type"},Ne={class:"timeline-content"},he={class:"notes-container"},$e={class:"note-header"},xe={class:"note-content"},Le={class:"dialog-content"},Se={class:"field"},Ue={class:"field"},Ae={class:"field"},Ie={class:"field"},Re={class:"dialog-content"},Me={class:"field"},Be={class:"field"},Ee={class:"field"},qe={class:"dialog-content"},ze={class:"field"},Fe=Q({__name:"LeadDetailView",setup(He){const p=X(),c=J(),S=ie(),d=C(()=>c.getLeadById(p.params.id)),I=C(()=>c.getLeadTasks(p.params.id)),f=v(!1),r=v({type:"bellen",title:"",description:"",scheduledDate:new Date,completed:!1}),R=()=>{c.addTask({leadId:p.params.id,...r.value}),f.value=!1,r.value={type:"bellen",title:"",description:"",scheduledDate:new Date,completed:!1}},M=a=>{c.updateTask(a.id,a)},B=C(()=>c.getLeadNotes(p.params.id).sort((a,e)=>new Date(e.createdAt).getTime()-new Date(a.createdAt).getTime())),b=v(!1),w=v({content:""}),E=()=>{c.addNote({leadId:p.params.id,content:w.value.content}),b.value=!1,w.value.content=""},q=a=>{S.require({message:"Are you sure you want to delete this note?",header:"Delete Confirmation",icon:"pi pi-info-circle",acceptClass:"p-button-danger",accept:()=>{c.deleteNote(a)}})},z=C(()=>c.getLeadCommunications(p.params.id).sort((a,e)=>new Date(e.timestamp).getTime()-new Date(a.timestamp).getTime())),y=v(!1),m=v({type:"outbound",method:"bellen",content:""}),F=()=>{c.addCommunication({leadId:p.params.id,type:m.value.type,method:m.value.method,timestamp:new Date().toISOString(),content:m.value.content}),y.value=!1,m.value={type:"outbound",method:"bellen",content:""}},V=[{label:"Call",value:"bellen"},{label:"Meeting",value:"afspraak"},{label:"Email",value:"mailen"},{label:"Research",value:"uitzoeken"}],H=[{label:"Outbound",value:"outbound"},{label:"Inbound",value:"inbound"}],U=a=>{var e;return((e=V.find(_=>_.value===a))==null?void 0:e.label)||a},k=a=>new Date(a).toLocaleDateString("nl-NL",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),G=a=>a?new Intl.NumberFormat("nl-NL",{style:"currency",currency:"EUR"}).format(a):"",O=a=>({"Hot en snel beslissen":"danger",Hot:"danger","Snel beslissen":"warning","Goede kans":"success","Goede kans, warm houden":"success",Standaard:"info","Niets mee doen":"secondary"})[a]||"info",j=()=>{S.require({message:"Are you sure you want to delete this lead?",header:"Delete Confirmation",icon:"pi pi-exclamation-triangle",accept:()=>{}})};return K(()=>{d.value||console.error("Lead not found")}),(a,e)=>{const _=Y("Timeline");return d.value?(h(),N("div",de,[t("div",ue,[t("div",re,[t("h1",null,i(d.value.name),1),s(o(A),{value:d.value.status,severity:O(d.value.status)},null,8,["value","severity"])]),t("div",me,[s(o(u),{icon:"pi pi-pencil",onClick:e[0]||(e[0]=l=>a.showEditDialog=!0),class:"p-button-text"}),s(o(u),{icon:"pi pi-trash",onClick:j,class:"p-button-text p-button-danger"})])]),t("div",ce,[t("div",pe,[s(o(D),{header:"Lead Information",class:"info-panel"},{default:n(()=>[t("div",ve,[t("div",fe,[e[18]||(e[18]=t("label",null,"Email",-1)),t("div",null,i(d.value.email||"Not specified"),1)]),t("div",be,[e[19]||(e[19]=t("label",null,"Phone",-1)),t("div",null,i(d.value.phone||"Not specified"),1)]),t("div",ye,[e[20]||(e[20]=t("label",null,"Decision Date",-1)),t("div",null,i(k(d.value.decisionDate)||"Not specified"),1)]),t("div",we,[e[21]||(e[21]=t("label",null,"Quotation Value",-1)),t("div",null,i(G(d.value.quotationValue)||"Not specified"),1)]),t("div",ke,[e[22]||(e[22]=t("label",null,"Priority",-1)),t("div",null,i(d.value.priority||"Not specified")+"/10",1)]),t("div",Ce,[e[23]||(e[23]=t("label",null,"Success Rate",-1)),t("div",null,i(d.value.successRate||"Not specified")+"%",1)]),t("div",ge,[e[24]||(e[24]=t("label",null,"Lead Score",-1)),t("div",null,i(d.value.leadscore),1)])])]),_:1}),s(o(D),{header:"Tasks",class:"tasks-panel"},{icons:n(()=>[s(o(u),{icon:"pi pi-plus",onClick:e[1]||(e[1]=l=>f.value=!0),class:"p-button-text p-button-sm"})]),default:n(()=>[s(o(Z),{value:I.value,class:"tasks-table"},{default:n(()=>[s(o(g),{field:"type",header:"Type"},{body:n(({data:l})=>[s(o(A),{value:U(l.type)},null,8,["value"])]),_:1}),s(o(g),{field:"title",header:"Title"}),s(o(g),{field:"scheduledDate",header:"Date"},{body:n(({data:l})=>[P(i(k(l.scheduledDate)),1)]),_:1}),s(o(g),{field:"completed",header:"Status"},{body:n(({data:l})=>[s(o(ee),{modelValue:l.completed,"onUpdate:modelValue":T=>l.completed=T,onChange:T=>M(l),binary:!0},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})]),_:1},8,["value"])]),_:1})]),t("div",De,[s(o(D),{header:"Communication History",class:"history-panel"},{icons:n(()=>[s(o(u),{icon:"pi pi-plus",onClick:e[2]||(e[2]=l=>y.value=!0),class:"p-button-text p-button-sm"})]),default:n(()=>[s(_,{value:z.value,class:"history-timeline"},{content:n(l=>[t("div",Ve,[t("small",_e,i(k(l.item.timestamp)),1),t("div",Te,i(l.item.type==="outbound"?"Sent":"Received")+" "+i(U(l.item.method)),1),t("div",Ne,i(l.item.content),1)])]),_:1},8,["value"])]),_:1}),s(o(D),{header:"Notes",class:"notes-panel"},{icons:n(()=>[s(o(u),{icon:"pi pi-plus",onClick:e[3]||(e[3]=l=>b.value=!0),class:"p-button-text p-button-sm"})]),default:n(()=>[t("div",he,[(h(!0),N(te,null,le(B.value,l=>(h(),N("div",{key:l.id,class:"note-item"},[t("div",$e,[t("small",null,i(k(l.createdAt)),1),s(o(u),{icon:"pi pi-trash",onClick:T=>q(l.id),class:"p-button-text p-button-danger p-button-sm"},null,8,["onClick"])]),t("div",xe,i(l.content),1)]))),128))])]),_:1})])]),s(o(x),{visible:f.value,"onUpdate:visible":e[9]||(e[9]=l=>f.value=l),modal:"",header:"New Task",style:{width:"450px"}},{footer:n(()=>[s(o(u),{label:"Cancel",onClick:e[8]||(e[8]=l=>f.value=!1),class:"p-button-text"}),s(o(u),{label:"Create",onClick:R,autofocus:""})]),default:n(()=>[t("div",Le,[t("div",Se,[e[25]||(e[25]=t("label",{for:"taskType"},"Type*",-1)),s(o($),{id:"taskType",modelValue:r.value.type,"onUpdate:modelValue":e[4]||(e[4]=l=>r.value.type=l),options:V,placeholder:"Select Type",class:"w-full"},null,8,["modelValue"])]),t("div",Ue,[e[26]||(e[26]=t("label",{for:"taskTitle"},"Title*",-1)),s(o(se),{id:"taskTitle",modelValue:r.value.title,"onUpdate:modelValue":e[5]||(e[5]=l=>r.value.title=l),class:"w-full"},null,8,["modelValue"])]),t("div",Ae,[e[27]||(e[27]=t("label",{for:"taskDate"},"Date*",-1)),s(o(ne),{id:"taskDate",modelValue:r.value.scheduledDate,"onUpdate:modelValue":e[6]||(e[6]=l=>r.value.scheduledDate=l),showTime:"",class:"w-full"},null,8,["modelValue"])]),t("div",Ie,[e[28]||(e[28]=t("label",{for:"taskDescription"},"Description",-1)),s(o(L),{id:"taskDescription",modelValue:r.value.description,"onUpdate:modelValue":e[7]||(e[7]=l=>r.value.description=l),rows:"3",class:"w-full"},null,8,["modelValue"])])])]),_:1},8,["visible"]),s(o(x),{visible:y.value,"onUpdate:visible":e[14]||(e[14]=l=>y.value=l),modal:"",header:"Add Communication",style:{width:"450px"}},{footer:n(()=>[s(o(u),{label:"Cancel",onClick:e[13]||(e[13]=l=>y.value=!1),class:"p-button-text"}),s(o(u),{label:"Add",onClick:F,autofocus:""})]),default:n(()=>[t("div",Re,[t("div",Me,[e[29]||(e[29]=t("label",{for:"commType"},"Type*",-1)),s(o($),{id:"commType",modelValue:m.value.type,"onUpdate:modelValue":e[10]||(e[10]=l=>m.value.type=l),options:H,placeholder:"Select Type",class:"w-full"},null,8,["modelValue"])]),t("div",Be,[e[30]||(e[30]=t("label",{for:"commMethod"},"Method*",-1)),s(o($),{id:"commMethod",modelValue:m.value.method,"onUpdate:modelValue":e[11]||(e[11]=l=>m.value.method=l),options:V,placeholder:"Select Method",class:"w-full"},null,8,["modelValue"])]),t("div",Ee,[e[31]||(e[31]=t("label",{for:"commContent"},"Content*",-1)),s(o(L),{id:"commContent",modelValue:m.value.content,"onUpdate:modelValue":e[12]||(e[12]=l=>m.value.content=l),rows:"3",class:"w-full"},null,8,["modelValue"])])])]),_:1},8,["visible"]),s(o(x),{visible:b.value,"onUpdate:visible":e[17]||(e[17]=l=>b.value=l),modal:"",header:"Add Note",style:{width:"450px"}},{footer:n(()=>[s(o(u),{label:"Cancel",onClick:e[16]||(e[16]=l=>b.value=!1),class:"p-button-text"}),s(o(u),{label:"Add",onClick:E,autofocus:""})]),default:n(()=>[t("div",qe,[t("div",ze,[e[32]||(e[32]=t("label",{for:"noteContent"},"Note Content*",-1)),s(o(L),{id:"noteContent",modelValue:w.value.content,"onUpdate:modelValue":e[15]||(e[15]=l=>w.value.content=l),rows:"4",class:"w-full",autoResize:""},null,8,["modelValue"])])])]),_:1},8,["visible"]),s(o(oe))])):W("",!0)}}});const We=ae(Fe,[["__scopeId","data-v-a446db6b"]]);export{We as default};
